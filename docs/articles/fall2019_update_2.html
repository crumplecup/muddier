<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>fall2019_update_2 • muddier</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="fall2019_update_2">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">muddier</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/muddier.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/fall2019_update.html">fall2019_update</a>
    </li>
    <li>
      <a href="../articles/fall2019_update_2.html">fall2019_update_2</a>
    </li>
    <li>
      <a href="../articles/horsetrader.html">horsetrader</a>
    </li>
    <li>
      <a href="../articles/summer2019_update.html">summer2019_update</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>fall2019_update_2</h1>
                        <h4 class="author">Erik Rose</h4>
            
            <h4 class="date">2019-11-05</h4>
      
      
      <div class="hidden name"><code>fall2019_update_2.Rmd</code></div>

    </div>

    
    
<div id="characterizing-landslide-debris-flows-in-ocr-headwater-streams" class="section level3">
<h3 class="hasAnchor">
<a href="#characterizing-landslide-debris-flows-in-ocr-headwater-streams" class="anchor"></a>Characterizing landslide debris flows in OCR headwater streams</h3>
<blockquote>
<p>What I like to say when the ground gives way is that dirt moves around in a hurry of slurry, and where it shall stop is a point of inquiry.</p>
</blockquote>
<p>With the output of the Miller/Burnett landslide model, we have an expected probability of debris flow delivery to different parts of a stream. From the Lancaster dataset, there are several points along the stream where we have measured the time before departure of deposits along the bank of the stream. And then from Lancaster’s transect surveys, we know the cross-sectional area of deposits along the stream between the valley walls, as well as the top width of the valley walls and the contributing area along the stream. By its nature, the transect survey records deposits that have arrived and not yet departed. We do not know how many deposits have arrived and departed prior, being washed away in stormflow or scoured out by another debris flow, so relating the transect record to a probability of debris flow arrival is problematic.</p>
<p>Knowing the volume of deposits between the valley walls does not tell us which deposits arrived by debris flows rather than fluvial processes. Generally speaking larger contributing area creates more potential for debris flows, but debris flows decrease as a stream decreases in slope and the valley walls widen. We would not expect an equal likelihood along the stream of deposit volumes consisting of debris flows.</p>
<p>As we wonder how to account for debris flow deliveries that have departed prior to measuring, it is useful to reflect on how they are departing. The erosive power of the stream depends upon a volume of water propelled by gravity, so lacking either water or gravity a deposit will squat where it is indefinitely. Where the slope is steep and water is plentiful, the stream has greater potential to evacuate debris from a deposit. We would not expect an equal likelihood of deposit duration along the stream, based on local variations in stream power. We would expect that as stream power increases, so does the likelihood of a deposit in the stream departing prior to measure.</p>
<p>The net effect of previous arrivals and departures leaves us with a record of volumes that is incomplete. When deposit volumes are high and delivery probabilities are high, this is as expected. When deposit volumes are low and delivery probabilities are low, this is also expected. But when deposit volumes are low and delivery probabilities are high, then our expectation is uncertain. If the stream power is more intense, we can reason that low volume does not necessarily imply lack of delivery, but there is no way to distinguish between places where the volume is low due to prior evacuation from places where it is low because no deposit arrived in the first place. We cannot classify these instances as either behaving as expected or unexpected without knowing which case applies.</p>
<p>Trying to wrap my head around the net effect of prior evacuations, I use the analogy of a teacup. The sides of the valley wall are the teacup, and deposit volumes within the valley are the tea in the cup. The erosive effect of the stream evacuating deposits is the guest drinking tea from the cup, and the surrounding hillslope is the benevolent host that occasionally refills the cup with tea.</p>
<p>The transect surveys record the sizes of teacups at the party and how much tea each contains. One might expect larger teacups to be more likely to contain more tea than smaller teacups, because they can hold more. On the other hand, one might consider it more remarkable to find a large volume of tea in a small cup, compared to finding the same amount of tea in a larger cup, because the smaller cup is fuller.</p>
</div>
<div id="the-teacup-model" class="section level3">
<h3 class="hasAnchor">
<a href="#the-teacup-model" class="anchor"></a>The Teacup Model</h3>
<p>So what does the transect record tell us about delivery probability? How can we relate arrival probabilities to the record of deposits yet to depart, given the constraints mentioned above? The model I arrived at is named after the teacup analogy above as a pneumonic to help me remember the differt parts of the formula.</p>
<p>In the model, the teacup is cross-sectional area divided by valley width. This is the average depth of deposits; if you took all the dirt in the valley and stretched it evenly over a length equal to the valley width, it would come to this depth. Since the cross-sectional area is the tea, and the valley wall is the cup, dividing tea by cup gives us the beverage level. Bigger teacups need to be fuller to have the same beverage level as smaller teacups. As a waiter I used to roam my section of the restaurant monitoring beverage levels, looking to fill glasses that were less than half full, regardless of the size of the glass. In this case I do not know exactly how much tea each cup can hold, only the diameter of the cup, so I use the absolute beverage level in meters rather than percent fullness, like I used to do in my waiter days.</p>
<p>The next thing I imagine is a forearm and hand reaching down to take the handle of the teacup. Where the tea represents deposit volumes, the hillslope is the host reaching for the cup to refill it with tea. The second term in the model is for contributing area. So far, the tea in the cup represents all deposit types, not just debris flows. Based upon contributing area, I can weigh the importantance of deposit volumes, given their likelihood of being debris flows. I will go into more detail on the weighting function below.</p>
<p>Now imagine a pair of lips coming to the teacup to drink. Drinking the tea represents the power of the stream to evacuate debris. The streampower term in the model weights the importance of tea volumes based upon local variations in streampower. Where streampower is low, this term discounts high volumes, while high volumes in areas of high streampower receive more weight.</p>
<p>Let <span class="math inline">\(K\)</span> represent the lips (streampower), <span class="math inline">\(V\)</span> the beverage level (ave. volume depth), <span class="math inline">\(C\)</span> the contributing hand (contributing area) and <span class="math inline">\(P\)</span> the probability of the host refilling the teacup (debris flow delivery probalility). We can represent the relationship between an optimized delivery probability <span class="math inline">\(P_O\)</span> and MB delivery probabilities <span class="math inline">\(P\)</span> using a weighting term <span class="math inline">\(V_{wt}\)</span> so that:</p>
<p><span class="math display">\[ V_{wt} = P \cdot K \cdot V \cdot C  \]</span> <span class="math display">\[ P_O = P \cdot V_{wt} \]</span></p>
<p>The following code computes the <span class="math inline">\(V\)</span> term, which I have nick-named ‘beverage level’:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(muddier)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(sp)
trunc_creeks &lt;-<span class="st"> </span>creeks[creeks<span class="op">$</span>xsec_area <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>,]

bev_lev &lt;-<span class="st"> </span>trunc_creeks<span class="op">$</span>xsec_area <span class="op">/</span><span class="st"> </span>trunc_creeks<span class="op">$</span>valley_width

<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(bev_lev)
<span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span class="co">#&gt; 0.05286 0.79289 1.18402 1.33224 1.63875 6.17465</span></code></pre></div>
<p><img src="fall2019_update_2_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<p>The following code computes the <span class="math inline">\(C\)</span> term in the model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
log10_xsec_area &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Log">log10</a></span>(trunc_creeks<span class="op">$</span>xsec_area)
log10_contr_area &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Log">log10</a></span>(trunc_creeks<span class="op">$</span>contr_area)

loglog_xsec_contr &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/lm">lm</a></span>(log10_xsec_area <span class="op">~</span><span class="st"> </span>log10_contr_area)
loglog_xsec_contr_theta &lt;-<span class="st"> </span>loglog_xsec_contr<span class="op">$</span>coefficients[<span class="dv">2</span>]
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(loglog_xsec_contr)
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = log10_xsec_area ~ log10_contr_area)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;      Min       1Q   Median       3Q      Max </span>
<span class="co">#&gt; -1.14267 -0.20757 -0.01496  0.22019  0.92245 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;                  Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co">#&gt; (Intercept)       1.37689    0.01170   117.7   &lt;2e-16 ***</span>
<span class="co">#&gt; log10_contr_area  0.88278    0.02515    35.1   &lt;2e-16 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 0.3422 on 854 degrees of freedom</span>
<span class="co">#&gt; Multiple R-squared:  0.5906, Adjusted R-squared:  0.5901 </span>
<span class="co">#&gt; F-statistic:  1232 on 1 and 854 DF,  p-value: &lt; 2.2e-16</span></code></pre></div>
<p><img src="fall2019_update_2_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">log10_contr_coefs &lt;-<span class="st"> </span>log10_xsec_area <span class="op">-</span><span class="st"> </span>loglog_xsec_contr_theta <span class="op">*</span><span class="st"> </span>log10_contr_area
contr_coefs &lt;-<span class="st"> </span><span class="dv">10</span><span class="op">^</span>log10_contr_coefs
norm_contr_coefs &lt;-<span class="st"> </span>contr_coefs <span class="op">/</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">max</a></span>(contr_coefs)</code></pre></div>
<p>The following code computes the <span class="math inline">\(K\)</span> term of the model.</p>
</div>
<div id="weighting-by-area-slope-relation" class="section level3">
<h3 class="hasAnchor">
<a href="#weighting-by-area-slope-relation" class="anchor"></a>Weighting by Area-Slope Relation</h3>
<p>We can fit the area-slope relation to a power law where slope <span class="math inline">\(S\)</span> relates to contributing area <span class="math inline">\(A\)</span> by the function:</p>
<p><span class="math display">\[ S = k_sA^{-\theta}  \]</span></p>
<p>We can relate logged slope to logged contributing area using a linear model, so that:</p>
<p><span class="math display">\[  log(S) = log(k_sA^{-\theta})  \]</span> <span class="math display">\[  log(S) = log(k_s) - \theta log(A)  \]</span></p>
<p>where <span class="math inline">\(\theta\)</span> is the slope of a linear model with intercept <span class="math inline">\(log(k_s)\)</span>. Using the estimated <span class="math inline">\(\theta\)</span> for all surveyed creeks, we can back-calculate an individual <span class="math inline">\(k_s\)</span> for each channel node holding <span class="math inline">\(\theta\)</span> constant.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(magrittr)

<span class="co"># find ks values in S = ks(A^theta)</span>
lslope &lt;-<span class="st"> </span>(trunc_creeks<span class="op">$</span>GRADIENT<span class="op">+</span>.<span class="dv">015</span>) <span class="op">%&gt;%</span><span class="st"> </span>log10 <span class="co"># log slope with offset for negative grads</span>
lcontr &lt;-<span class="st"> </span>log10_contr_area <span class="co"># log contr area</span>
as_mod &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/lm">lm</a></span>(lslope <span class="op">~</span><span class="st"> </span>lcontr)  <span class="co"># fit AS to power law</span>
as_theta &lt;-<span class="st"> </span>as_mod<span class="op">$</span>coefficients[<span class="dv">2</span>]  <span class="co"># pull theta value</span>
sum_mod &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(as_mod)</code></pre></div>
<p><img src="fall2019_update_2_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># estimate individual ks values using pulled theta</span>
log_ks &lt;-<span class="st"> </span>lslope <span class="op">-</span><span class="st"> </span>as_theta <span class="op">*</span><span class="st"> </span>lcontr
ks &lt;-<span class="st"> </span><span class="dv">10</span><span class="op">^</span>log_ks
norm_ks &lt;-<span class="st"> </span>ks <span class="op">/</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">max</a></span>(ks)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vol_wt &lt;-<span class="st"> </span>norm_ks <span class="op">*</span><span class="st"> </span>bev_lev <span class="op">*</span><span class="st"> </span>norm_contr_coefs
vol_wt &lt;-<span class="st"> </span>vol_wt <span class="op">/</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">max</a></span>(vol_wt)
p_o &lt;-<span class="st"> </span>trunc_creeks<span class="op">$</span>DebrisFlow <span class="op">*</span><span class="st"> </span>vol_wt</code></pre></div>
<p><img src="fall2019_update_2_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>Optimizing our indicator of delivery probability is not so much a matter of declaring the MB probabilities we have good or bad, as it is how much we can improve them given the additional data we have. To carry forward the tea analogy all the way to the end, imagine the mountain valley is a tea shop. The streams have been divided into tables for guests as wide as the stream and either 10 meters long or 14 meters long for the extra large booths. Each table holds different sized tea cups, depending on the valley width. The manager assigns a server to pour tea into the cups for guests to drink. Back in the kitchen, the cooks brew big pots of tea for the servers to draw from for the guests.</p>
<p>The shrewd manager is trying to project how much tea the cooks need to brew each night, in order to avoid either running out of tea or brewing too much, but the manager does not know how many guests are going to check in because the tea shop does not take reserversations. Previously, the manager had been using the average tea sales for that night, but recently got the clever idea to predict variations from average tea sales based upon the laziness or assertiveness of the server.</p>
<p>A lazy server will fail to refill teacups for guests, even when the guest is thirsty and wants more tea, reducing sales. An attentive server will refill teacups when guests want more, increasing sales efficiently. An overly pushy server will keep offering to refill teacups when guests are not thirsty, exerting additional effort without increasing sales.</p>
<p>As an example, I used to wait tables on a cruise ship that did circles around Elliot Bay in Seattle. As a novelty, the bar sold plastic icecubes with colored LED light displays during the holiday season. One night I made a mocktail and added a single LED plastic icecube, and walked around the decks serving my section normally with the drink tagging along on my tray. By the first hour I had sold six, without having to say a word, with interested guests prompting me for a sale.</p>
<p>Seeing my gimmick, a fellow server swore immediately he would sell more fake icecubes than me, and returned from the bar with a garish stack of blinking and flashing icecubes, looking more like a merchant at a baseball stadium laden with wares than a server. He kept that up all night and sold far fewer than I. This ‘more is not always better’ philosophy may apply to the MB delivery probabilities, in the sense that once delivery probability gets sufficiently high, marginal increases provide diminishing returns, as the area is already likely to receive a debris flow.</p>
<p>Imagine if the manager ranked every server from lazy to pushy, and plotted them against the sales of each server. We would expect tea sales to increase as servers become less lazy, but then as servers become too pushy we would expect the increase to taper off.</p>
</div>
<div id="weighting-delivery-probabilities" class="section level2">
<h2 class="hasAnchor">
<a href="#weighting-delivery-probabilities" class="anchor"></a>Weighting Delivery Probabilities</h2>
<p>Let <span class="math inline">\(P\)</span> represent delivery probabilities, and let <span class="math inline">\(F_P (P_0)\)</span> be the CDF of delivery probabilities. Let <span class="math inline">\(V\)</span> represent depositional volume, and let <span class="math inline">\(F_V (P_0)\)</span> be the CDF of volume with respect to <span class="math inline">\(P\)</span>. The volume weighting function <span class="math inline">\(wt_V\)</span> over an interval <span class="math inline">\(P_i\)</span> to <span class="math inline">\(P_{i + 1}\)</span> along <span class="math inline">\(P\)</span> is:</p>
<p><span class="math display">\[ wt_V (P_i, P_{i+1}) = \frac{F_V (P_{i+1}) - F_V (P_i)}{F_P (P_{i+1}) - F_P (P_i)} \]</span></p>
<p>Using <span class="math inline">\(K\)</span> for the ratio of <span class="math inline">\(P/k_s\)</span>, let <span class="math inline">\(F_V(K_0)\)</span> be the CDF of <span class="math inline">\(V\)</span> with respect to <span class="math inline">\(P/k_s\)</span>. We can then compare change in the CDF of <span class="math inline">\(V\)</span> to change in the CDF of <span class="math inline">\(K\)</span>. The volume weighting function <span class="math inline">\(wt_{V_K}\)</span> over an interval <span class="math inline">\(K_i\)</span> to <span class="math inline">\(K_{i + 1}\)</span> along <span class="math inline">\(K\)</span> is:</p>
<p><span class="math display">\[ wt_{V_K} (K_i, K_{i+1}) = \frac{F_V (K_{i+1}) - F_V (K_i)}{F_K (K_{i+1}) - F_K (K_i)} \]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># weighting function for delivery probs</span>

<span class="co"># delivery prob index</span>
p_index &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sort">sort</a></span>(trunc_creeks<span class="op">$</span>DebrisFlow)

<span class="co"># cdf of delivery probs</span>
p_cdf &lt;-<span class="st"> </span><span class="kw"><a href="../reference/to_cdf.html">to_cdf</a></span>(p_index<span class="op">/</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(p_index))

<span class="co"># change in delivery prob cdf per change in index</span>
delta_p &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/vector">vector</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(p_index), <span class="dt">mode =</span> <span class="st">'numeric'</span>)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(delta_p))  {
  delta_p[i] &lt;-<span class="st"> </span>p_cdf[i] <span class="op">-</span><span class="st"> </span>p_cdf[i<span class="op">-</span><span class="dv">1</span>]
}

<span class="co"># cdf of volume by prob index</span>
v_cdf &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/vector">vector</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(p_index), <span class="dt">mode =</span> <span class="st">'numeric'</span>)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(v_cdf))  {
  v_cdf[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(vol_wt[trunc_creeks<span class="op">$</span>DebrisFlow <span class="op">&lt;=</span><span class="st"> </span>p_index[i]]) <span class="op">/</span>
<span class="st">    </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(vol_wt)
}

<span class="co"># change in volume cdf per change in index</span>
delta_v &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/vector">vector</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(p_index), <span class="dt">mode =</span> <span class="st">'numeric'</span>)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(delta_v))  {
  delta_v[i] &lt;-<span class="st"> </span>v_cdf[i] <span class="op">-</span><span class="st"> </span>v_cdf[i<span class="op">-</span><span class="dv">1</span>]
}

<span class="co"># change in volume cdf per change in del prob cdf</span>
p_wt &lt;-<span class="st"> </span>delta_v <span class="op">/</span><span class="st"> </span>(delta_p <span class="op">+</span><span class="st"> </span>.<span class="dv">0000000001</span>)
log_pwt &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Log">log10</a></span>(p_wt <span class="op">+</span><span class="st"> </span>.<span class="dv">0001</span>)
log10_df &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Log">log10</a></span>(trunc_creeks<span class="op">$</span>DebrisFlow)
bin_log_pwt &lt;-<span class="st"> </span><span class="kw"><a href="../reference/bin_by.html">bin_by</a></span>(log10_df, log_pwt, <span class="dv">10</span>)</code></pre></div>
<p><img src="fall2019_update_2_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
</div>
<div id="next-steps" class="section level2">
<h2 class="hasAnchor">
<a href="#next-steps" class="anchor"></a>Next Steps</h2>
<ul>
<li>Georeference Lancaster transect data for Golden Ridge Creek.</li>
<li>Georeference radiocarbon sites along Cedar and Golden Ridge creeks.</li>
<li>Survey data includes strat columns and fraction debris flow.</li>
<li>Weight delivery probabilities at radiocarbon sites by fraction debris flow.</li>
<li>Compare Lancaster transect slope data to the DEM-derived MB slope.</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#weighting-delivery-probabilities">Weighting Delivery Probabilities</a></li>
      <li><a href="#next-steps">Next Steps</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Erik Rose.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
